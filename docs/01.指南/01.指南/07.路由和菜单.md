---
title: 路由和菜单（持续更新中）
date: 2022-12-06
permalink: /pages/routerMenu/
---

## 路由和菜单配置

::: details 点击查看完整路由和菜单配置

```Ts
interface RouteConfigsTable {
  // 路由地址
  path: string;
  // 路由名字（必须保持唯一）
  name: string;
  // 路由重定向
  redirect: string;
  // 路由元信息，通俗来说就是路由上的额外信息 https://router.vuejs.org/zh/guide/advanced/meta.html#%E8%B7%AF%E7%94%B1%E5%85%83%E4%BF%A1%E6%81%AF
  meta: {
    // 菜单名称（兼容国际化、非国际化，如果用国际化的写法就必须在根目录的locales文件夹下对应添加）
    title: string;
    // 菜单图标
    icon: string;
    // 是否在菜单中显示
    showLink: boolean;
    // 菜单排序，值越高排的越后（只针对顶级路由）
    rank: number;
  };
  // 子路由配置项
  children: [
    {
      // 路由地址
      path: string;
      // 路由名字（必须唯一并且和当前路由component字段对应的页面里用defineOptions包起来的name保持一致）
      name: string;
      // 路由重定向
      redirect: string;
      // 按需加载需要展示的页面
      component: RouteComponent;
      // 路由元信息
      meta: {
        // 菜单名称（兼容国际化、非国际化，如果用国际化的写法就必须在根目录的locales文件夹下对应添加）
        title: string;
        // 菜单图标
        icon: string;
        // 菜单名称右侧的额外图标
        extraIcon: {
          // 是否是svg
          svg: boolean;
          // iconfont名称，目前只支持iconfont，后续拓展
          name: string;
        };
        // 是否显示该菜单
        showLink: boolean;
        // 是否显示父级菜单
        showParent: boolean;
        // 页面级别权限设置
        roles: Array<string>;
        // 按钮级别权限设置
        auths: Array<string>;
        // 是否缓存该路由页面（开启后，会保存该页面的整体状态，刷新后会清空状态）
        keepAlive: boolean;
        // 需要内嵌的iframe链接地址
        frameSrc: string;
        // 内嵌的iframe页面是否开启首次加载动画
        frameLoading: boolean;
        // 页面加载动画（两种模式，第一种直接采用vue内置的transitions动画，第二种是使用animate.css编写进、离场动画，平台更推荐使用第二种模式，已经内置了animate.css，直接写对应的动画名即可）
        transition: {
          // 当前页面动画，这里是第一种模式，比如 name: "fade" 更具体看后面链接 https://cn.vuejs.org/api/built-in-components.html#transition
          name: string;
          // 当前页面进场动画，这里是第二种模式，比如 enterTransition: "animate__fadeInLeft"
          enterTransition: string;
          // 当前页面离场动画，这里是第二种模式，比如 leaveTransition: "animate__fadeOutRight"
          leaveTransition: string;
        };
        // 当前菜单名称或自定义信息禁止添加到标签页
        hiddenTag: boolean;
        // 显示在标签页的最大数量，需满足后面的条件：不显示在菜单中的路由并且是通过query或params传参模式打开的页面。在完整版全局搜dynamicLevel即可查看代码演示
        dynamicLevel: number;
      };
    },
  ],
};
```

:::

## 静态路由

在前端代码里写上固定的路由即静态路由。平台支持任意层级菜单格式，下面列举最常用的菜单层级模式，更深层级按照下面格式即可

### 如何生成一级菜单

::: details

比如我们要生成一个名为 `加油` 的菜单

1. 新建 `src/router/modules/fighting.ts` 文件，加入如下代码

`fighting.ts`

```Ts
// 最简代码，也就是这些字段必须有
export default {
  path: "/fighting",
  meta: {
    title: "加油"
  },
  children: [
    {
      path: "/fighting/index",
      name: "Fighting",
      component: () => import("@/views/fighting/index.vue"),
      meta: {
        title: "加油"
      }
    }
  ]
};
```

2. 新建 `src/views/fighting/index.vue` 文件，加入如下代码

`index.vue`

```Vue
<script setup lang="ts">
defineOptions({
  // name 作为一种规范最好必须写上并且和路由的name保持一致
  name: "Fighting"
});
</script>

<template>
  <h1>加油</h1>
</template>
```

上面所写代码如下图效果

![static1](~@alias/img/router/static1.jpg)

:::

### 如何生成二级菜单（两种模式）

#### 第一种（该模式针对父级菜单下只有一个子菜单的情况，在子菜单的 `meta` 属性中加上 `showParent: true` 即可）

::: details 点击查看

```Ts
// 最简代码，也就是这些字段必须有
export default {
  path: "/fighting",
  meta: {
    title: "励志"
  },
  children: [
    {
      path: "/fighting/index",
      name: "Fighting",
      component: () => import("@/views/fighting/index.vue"),
      meta: {
        title: "加油",
        // 通过设置showParent为true，显示父级
        showParent: true
      }
    }
  ]
};
```

如下图效果

![static2](~@alias/img/router/static2.jpg)

:::

#### 第二种（该模式针对父级菜单下有大于或等于两个子菜单的情况）

::: details 点击查看

```Ts
// 最简代码，也就是这些字段必须有
export default {
  path: "/fighting",
  meta: {
    title: "励志"
  },
  children: [
    {
      path: "/fighting/index",
      name: "Fighting",
      component: () => import("@/views/fighting/index.vue"),
      meta: {
        title: "加油"
      }
    },
    {
      path: "/fighting/effort",
      name: "Effort",
      component: () => import("@/views/fighting/effort.vue"),
      meta: {
        title: "努力"
      }
    }
  ]
};
```

如下图效果

![static3](~@alias/img/router/static3.jpg)

:::

### 如何生成三级菜单（两种模式）

#### 第一种（该模式针对父级菜单下只有一个子菜单的情况，在子菜单的 `meta` 属性中加上 `showParent: true` 即可）

::: details 点击查看

```Ts
// 最简代码，也就是这些字段必须有
export default {
  path: "/nested",
  meta: {
    title: "多级菜单"
  },
  children: [
    {
      path: "/nested/menu1",
      meta: {
        title: "菜单1"
      },
      children: [
        {
          path: "/nested/menu1/menu1-1",
          component: () => import("@/views/nested/menu1/menu1-1/index.vue"),
          name: "Menu1-1",
          meta: {
            title: "菜单1-1",
            // 通过设置showParent为true，显示父级
            showParent: true
          }
        }
      ]
    }
  ]
};
```

如下图效果

![static4](~@alias/img/router/static4.jpg)

:::

#### 第二种（该模式针对父级菜单下有大于或等于两个子菜单的情况）

::: details 点击查看

```Ts
// 最简代码，也就是这些字段必须有
export default {
  path: "/nested",
  meta: {
    title: "多级菜单"
  },
  children: [
    {
      path: "/nested/menu1",
      meta: {
        title: "菜单1"
      },
      children: [
        {
          path: "/nested/menu1/menu1-1",
          component: () => import("@/views/nested/menu1/menu1-1/index.vue"),
          name: "Menu1-1",
          meta: {
            title: "菜单1-1"
          }
        },
        {
          path: "/nested/menu1/menu1-2",
          component: () => import("@/views/nested/menu1/menu1-2/index.vue"),
          name: "Menu1-2",
          meta: {
            title: "菜单1-2"
          }
        }
      ]
    }
  ]
};
```

如下图效果

![static5](~@alias/img/router/static5.jpg)

:::

### 如何生成四级菜单（两种模式）

#### 第一种（该模式针对父级菜单下只有一个子菜单的情况，在子菜单的 `meta` 属性中加上 `showParent: true` 即可）

::: details 点击查看

```Ts
// 最简代码，也就是这些字段必须有
export default {
  path: "/nested",
  meta: {
    title: "多级菜单"
  },
  children: [
    {
      path: "/nested/menu1",
      meta: {
        title: "菜单1"
      },
      children: [
        {
          path: "/nested/menu1/menu1-1",
          meta: {
            title: "菜单1-1"
          },
          children: [
            {
              path: "/nested/menu1/menu1-1/menu1-1-1",
              component: () =>
                import("@/views/nested/menu1/menu1-1/menu1-1-1/index.vue"),
              name: "Menu1-1-1",
              meta: {
                title: "菜单1-1-1",
                // 通过设置showParent为true，显示父级
                showParent: true
              }
            }
          ]
        }
      ]
    }
  ]
};
```

如下图效果

![static6](~@alias/img/router/static6.jpg)

:::

#### 第二种（该模式针对父级菜单下有大于或等于两个子菜单的情况）

::: details 点击查看

```Ts
// 最简代码，也就是这些字段必须有
export default {
  path: "/nested",
  meta: {
    title: "多级菜单"
  },
  children: [
    {
      path: "/nested/menu1",
      meta: {
        title: "菜单1"
      },
      children: [
        {
          path: "/nested/menu1/menu1-1",
          meta: {
            title: "菜单1-1"
          },
          children: [
            {
              path: "/nested/menu1/menu1-1/menu1-1-1",
              component: () =>
                import("@/views/nested/menu1/menu1-1/menu1-1-1/index.vue"),
              name: "Menu1-1-1",
              meta: {
                title: "菜单1-1-1"
              }
            },
            {
              path: "/nested/menu1/menu1-1/menu1-1-2",
              component: () =>
                import("@/views/nested/menu1/menu1-1/menu1-1-2/index.vue"),
              name: "Menu1-1-2",
              meta: {
                title: "菜单1-1-2"
              }
            }
          ]
        }
      ]
    }
  ]
};
```

如下图效果

![static7](~@alias/img/router/static7.jpg)

:::

### 注意点

#### 重定向

可以看到上面生成菜单的路由配置项我并没有加上 `redirect` 属性，当使用 `fighting` 路径跳转时，就会跑到 `404` 页面，如下图

![redirect](~@alias/img/router/redirect.gif)

所以我们最好在写静态路由配置时将父级加上 `redirect` 属性，`redirect` 可以填写您想要重定向的 `path` 即可，具体可以参考 [src/router/modules/nested.ts](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/router/modules/nested.ts)

#### 类型提示

分两种

1. `export default` 后跟 `{}`，这也是最常用的一种，在路由的配置项最后加上 `as RouteConfigsTable` 即可获得类型提示，如下图

![static10](~@alias/img/router/static10.jpg)

2. `export default` 后跟 `[]`，在路由的配置项最后加上 `as Array<RouteConfigsTable>` 即可获得类型提示，如下图

![static11](~@alias/img/router/static11.jpg)

:::tip 您肯定想问 RouteConfigsTable 是哪里来的呢？
[我在这呢，快快点我查看 😊](https://gitee.com/yiming_chang/pure-admin-thin/blob/main/types/global.d.ts#L223)
:::

#### 禁止修改或删除的路由

`src/router/modules` 文件夹里的 `home.ts`、`remaining.ts`、`error.ts` 这三个文件不可修改或删除，因为平台的某些核心逻辑是根据这三个文件作处理

![static8](~@alias/img/router/static8.jpg)

如果不想在页面显示，在顶级路由的 `meta` 属性加上 `showLink: false` 即可，如下图

![static9](~@alias/img/router/static9.jpg)

#### 添加无 `layout` 的页面

使用场景：需要外嵌平台某个页面，不需要展示菜单导航以及额外模块，只需要展示业务内容模块  
无 `layout` 页面也就相当于一个全屏空白页面，没有菜单导航以及额外模块，如下图

![layout](~@alias/img/router/layout.gif)

如何添加？

1. 在 `src/router/modules/remaining.ts` 文件添加对应路由 [具体参考](https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/router/modules/remaining.ts#L32)

2. 添加对应业务代码页面 [具体参考](https://gitee.com/yiming_chang/vue-pure-admin/tree/main/src/views/empty)

:::tip 温馨提示
必须在 `src/router/modules/remaining.ts` 文件添加哦
:::

## 动态路由

待更新

## 静态、动态路由相同的配置

待更新

## 菜单

待更新
