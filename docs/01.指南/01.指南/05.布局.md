---
title: 布局
date: 2021-11-17 16:44:33
permalink: /pages/93bd0d/
---

## 概述

整个项目的关键骨架由路由和侧边栏组织起来，在说路由之前，我们先来看看整个骨架是如何布局出来的。

这里的布局以传统的布局方式作为界面基础，增加了一些实用的功能模块，使得用户体验更加的丝滑 ~~~~

![image-20211118154048088](https://gitee.com/huohuomua/pictures/raw/master/202111181540118.png)

## 结构设计

### 布局结构

这里以一个简化版的布局视图为例

![image-20211118160548675](https://gitee.com/huohuomua/pictures/raw/master/202111181605718.png)

回顾一下布局的目录结构

```
│   ├── layout									     # 主要页面布局
│   │   ├── components                                      # 布局组件
│   │   │   ├── panel
│   │   │   ├── screenfull
│   │   │   ├── setting
│   │   │   ├── sidebar                                     # 左部侧边栏
│   │   │   │   ├── breadCrumb.vue
│   │   │   │   ├── hamBurger.vue
│   │   │   │   ├── horizontal.vue
│   │   │   │   ├── logo.vue
│   │   │   │   ├── sidebarItem.vue
│   │   │   │   └── vertical.vue
│   │   │   ├── tag
│   │   │   ├── appMain.vue
│   │   │   └── navbar.vue
│   │   ├── index.vue                                       # 布局容器主体
│   │   └── types.ts                                        # 局部类型定义
```

注：一下图片红色字体标注均为组件名，这里为了文档的直观性和后续补充扩展，直接标注了出来，实际开发过程中你可以在谷歌浏览器安装 `Vue.js devtools`，享受更细致的开发体验。

![image-20211118193918161](https://gitee.com/huohuomua/pictures/raw/master/202111181939205.png)

### 代码设计

### layout

`layout` 作为整个布局的出入口，先看看对应的路由设计：

```typescript
// src/router/modules/home.ts
import Layout from "/@/layout/index.vue";

const homeRouter = {
  path: "/", // 作为系统首页
  name: "home",
  component: Layout, // 引入布局总容器组件
  redirect: "/welcome",
  meta: {
    icon: "HomeFilled",
    showLink: true,
    i18n: true,
    rank: 0
  },
  children: [
    ......
  ]
};

export default homeRouter;
```

通过 `layout` 的 HTML 结构，来梳理一下布局的脉络：

```vue
<template>
  <div :class="['app-wrapper', set.classes]" v-resize>
    <!-- 响应式处理-->
    <div
      v-show="
        set.device === 'mobile' &&
        set.sidebar.opened &&
        layout.includes('vertical')
      "
      class="drawer-bg"
      @click="handleClickOutside(false)"
    />
    <!-- （左）侧边栏 -->
    <Vertical v-show="!hiddenSideBar && layout.includes('vertical')" />
    <div :class="['main-container', hiddenSideBar ? 'main-hidden' : '']">
      <div v-if="set.fixedHeader">
        <!-- 布局的头部 -->
        <layout-header />
        <!-- 主体内容 -->
        <app-main :fixed-header="set.fixedHeader" />
      </div>
      <!-- 回到顶部滚动 -->
      <el-scrollbar v-else>
        <el-backtop
          title="回到顶部"
          target=".main-container .el-scrollbar__wrap"
          >
          <backTop />
        </el-backtop>
        <layout-header />
        <app-main :fixed-header="set.fixedHeader" />
      </el-scrollbar>
    </div>
    <!-- 系统设置 -->
    <setting />
  </div>
</template>
```

这里需要注意 `layout-header`组件，是在 `src/layout/index.vue` 中通过 [h 函数](https://v3.cn.vuejs.org/guide/render-function.html#h-%E5%8F%82%E6%95%B0)封装的自定义组件。

```js
const layoutHeader = defineComponent({
  render() {
    return h(
      ......
    );
  }
});
```

### vertical

![image-20211118195212241](https://gitee.com/huohuomua/pictures/raw/master/202111181952265.png)

### navbar

![image-20211118200345306](https://gitee.com/huohuomua/pictures/raw/master/202111182003335.png)

### tag

![image-20211118200426395](https://gitee.com/huohuomua/pictures/raw/master/202111182004427.png)

### appMain



## 其他



